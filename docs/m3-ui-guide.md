# M3 UI Guide - å–è¯è§†å›¾ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

Aetheris 2.0-M3 åœ¨ Trace UI ä¸­æ–°å¢ 3 ä¸ªå–è¯è§†å›¾ï¼š
- **Evidence Graph**: å†³ç­–ä¾æ®çš„å¯è§†åŒ–å›¾è°±
- **Decision Timeline**: æ ‡æ³¨å…³é”®å†³ç­–ç‚¹çš„æ—¶é—´çº¿
- **Audit Log**: è®¿é—®å®¡è®¡è®°å½•

---

## è®¿é—® Trace UI

```bash
# æµè§ˆå™¨æ‰“å¼€
http://localhost:8080/api/jobs/<job_id>/trace/page
```

---

## Evidence Graph Tab

### ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Timeline | Execution Tree | Evidence Graph | Audit â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚ Plan   â”‚ â”€â”€order_idâ”€â”€> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ Payment  â”‚            â”‚
â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                  â”‚                  â”‚
â”‚                              payment_result         â”‚
â”‚                                  â†“                  â”‚
â”‚                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚                             â”‚  Email   â”‚            â”‚
â”‚                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### äº¤äº’æ“ä½œ

**ç¼©æ”¾**:
- é¼ æ ‡æ»šè½®ï¼šæ”¾å¤§/ç¼©å°
- åŒå‡»ï¼šé‡ç½®è§†å›¾
- å·¥å…·æ ï¼šZoom In / Zoom Out / Fit

**å¯¼èˆª**:
- æ‹–æ‹½èƒŒæ™¯ï¼šå¹³ç§»è§†å›¾
- æ‹–æ‹½èŠ‚ç‚¹ï¼šé‡æ–°å¸ƒå±€ï¼ˆå¯é€‰ï¼‰

**é€‰æ‹©**:
- å•å‡»èŠ‚ç‚¹ï¼šæ˜¾ç¤ºè¯æ®è¯¦æƒ…
- Ctrl+Clickï¼šå¤šé€‰èŠ‚ç‚¹
- æ¡†é€‰ï¼šæ‹–æ‹½é€‰æ‹©å¤šä¸ªèŠ‚ç‚¹

**è¿‡æ»¤**:
- æŒ‰é’®ï¼šLLM Only | Tools Only | All
- æœç´¢æ¡†ï¼šæŒ‰èŠ‚ç‚¹ ID æˆ– label æœç´¢

### è¯æ®è¯¦æƒ…é¢æ¿

ç‚¹å‡»èŠ‚ç‚¹åå³ä¾§æ˜¾ç¤ºï¼š

```
â”Œâ”€ Evidence Detail â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step: Process Payment              â”‚
â”‚ Type: Tool Invocation              â”‚
â”‚ Node ID: node_b                    â”‚
â”‚                                    â”‚
â”‚ Evidence Nodes (3):                â”‚
â”‚   ğŸ”§ stripe.charge                 â”‚
â”‚      ID: inv_456                   â”‚
â”‚      Status: success               â”‚
â”‚      External: ch_abc123           â”‚
â”‚                                    â”‚
â”‚   ğŸ¤– LLM: gpt-4o                   â”‚
â”‚      Provider: openai              â”‚
â”‚      Temp: 0.7                     â”‚
â”‚      Tokens: 1234                  â”‚
â”‚                                    â”‚
â”‚   ğŸ” RAG: doc_789                  â”‚
â”‚      Similarity: 0.92              â”‚
â”‚                                    â”‚
â”‚ Causal Dependencies:               â”‚
â”‚   â† Reads:                         â”‚
â”‚      order_id (from step_a)        â”‚
â”‚   â†’ Writes:                        â”‚
â”‚      payment_result (to step_c)    â”‚
â”‚                                    â”‚
â”‚ Timestamp: 2026-02-12 10:30:45     â”‚
â”‚ Duration: 1.2s                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Decision Timeline Tab

### ç•Œé¢å¢å¼º

åœ¨åŸæœ‰ Timeline åŸºç¡€ä¸Šæ·»åŠ å…³é”®å†³ç­–æ ‡è®°ï¼š

```
Plan â”€â”€â”€â”€â”€â”€> Node â”€â”€â”€â”€â”€â”€> Tool â”€â”€â”€â”€â”€â”€> Node â”€â”€â”€â”€â”€â”€> Complete
              â†‘             â†‘             â†‘
              â”‚             â”‚             â”‚
           [LLM]        [Payment]      [Approval]
```

**æ ‡è®°ç±»å‹**:
- ğŸ’° Payment: payment_executed
- âœ‰ï¸ Email: email_sent
- âœ“ Approval: human_approval_given
- âš ï¸ Critical: critical_decision_made

### ç‚¹å‡»æ ‡è®°

ç‚¹å‡»æ ‡è®°è·³è½¬åˆ°å¯¹åº” step çš„è¯¦æƒ…ï¼Œå¹¶é«˜äº®ç›¸å…³è¯æ®ã€‚

---

## Audit Log Tab

### è®¿é—®è®°å½•è¡¨æ ¼

```
â”Œâ”€ Audit Log â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Time              User         Action          Result â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2026-02-12 10:00  admin        view_job       Successâ”‚
â”‚ 2026-02-12 10:05  auditor      view_trace     Successâ”‚
â”‚ 2026-02-12 10:10  admin        export_evidence Successâ”‚
â”‚ 2026-02-12 14:30  operator     stop_job       Successâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¿‡æ»¤é€‰é¡¹

- **æŒ‰ç”¨æˆ·**: é€‰æ‹©ç‰¹å®šç”¨æˆ·çš„è®¿é—®è®°å½•
- **æŒ‰æ“ä½œ**: view_job | export_evidence | stop_job
- **æŒ‰æ—¶é—´**: æœ€è¿‘ 1h | 24h | 7d | è‡ªå®šä¹‰

### å¯¼å‡ºå®¡è®¡

ç‚¹å‡»"Export Audit Log"æŒ‰é’®ï¼Œå¯¼å‡ºä¸º CSVï¼š

```csv
timestamp,user_id,action,resource_type,resource_id,success
2026-02-12T10:00:00Z,admin,view_job,job,job_123,true
2026-02-12T10:10:00Z,admin,export_evidence,job,job_123,true
```

---

## å…¸å‹å·¥ä½œæµ

### å·¥ä½œæµ 1: è°ƒæŸ¥å¯ç–‘æ“ä½œ

1. **å‘ç°å¼‚å¸¸**: ç›‘æ§å‘Šè­¦å‘ç°å¼‚å¸¸æ”¯ä»˜
2. **æŸ¥è¯¢ jobs**: POST /api/forensics/queryï¼ˆtool_filter: stripe*, event_filter: payment_executedï¼‰
3. **æŸ¥çœ‹ Evidence Graph**: ç‚¹å‡»å¯ç–‘ jobï¼Œåˆ‡æ¢åˆ° Evidence Graph tab
4. **è¿½æº¯å†³ç­–**: æ²¿ç€å› æœè¾¹å›æº¯ï¼Œæ‰¾åˆ°å†³ç­–ä¾æ®
5. **å¯¼å‡ºè¯æ®**: POST /api/jobs/:id/export
6. **å®¡æŸ¥ Audit Log**: æŸ¥çœ‹è°è®¿é—®è¿‡è¯¥ job

### å·¥ä½œæµ 2: åˆè§„å®¡è®¡

1. **å®šä¹‰æŸ¥è¯¢**: 2026-02-01 ~ 2026-02-12 æ‰€æœ‰æ”¯ä»˜ jobs
2. **æ‰¹é‡å¯¼å‡º**: POST /api/forensics/batch-export
3. **ç­‰å¾…å®Œæˆ**: è½®è¯¢ export-status
4. **ä¸‹è½½ç»“æœ**: è·å–æ‰¹é‡è¯æ®åŒ…
5. **ç¦»çº¿éªŒè¯**: aetheris verify æ¯ä¸ªè¯æ®åŒ…
6. **æäº¤æŠ¥å‘Š**: è¯æ®åŒ…æäº¤ç»™åˆè§„å›¢é˜Ÿ

### å·¥ä½œæµ 3: å›é¡¾å†³ç­–è´¨é‡

1. **ç­›é€‰å…³é”®å†³ç­–**: event_filter: critical_decision_made
2. **é€ä¸ªæŸ¥çœ‹**: Evidence Graph æŸ¥çœ‹å†³ç­–ä¾æ®
3. **è¯„ä¼°å®Œæ•´æ€§**: æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿè¯æ®æ”¯æŒ
4. **è¯†åˆ«æ¨¡å¼**: å“ªäº›å†³ç­–ç¼ºå°‘äººç±»å®¡æ‰¹ï¼Ÿ
5. **ä¼˜åŒ–æµç¨‹**: æ›´æ–°å†³ç­–ç­–ç•¥

---

## å¿«æ·é”®

- `Ctrl + F`: æœç´¢èŠ‚ç‚¹
- `Ctrl + E`: åˆ‡æ¢åˆ° Evidence Graph tab
- `Ctrl + A`: åˆ‡æ¢åˆ° Audit Log tab
- `Ctrl + T`: åˆ‡æ¢åˆ° Timeline tab
- `Ctrl + +/-`: æ”¾å¤§/ç¼©å°å›¾
- `Ctrl + 0`: é‡ç½®è§†å›¾

---

## æ€§èƒ½æç¤º

### å¤§å‹ Jobs

å¯¹äºäº‹ä»¶æ•° > 1000 çš„ jobsï¼š
- ä½¿ç”¨è¿‡æ»¤å™¨ï¼ˆåªæ˜¾ç¤ºå…³é”®èŠ‚ç‚¹ï¼‰
- åˆ†æ®µæŸ¥çœ‹ï¼ˆæŒ‰æ—¶é—´èŒƒå›´ï¼‰
- å¯¼å‡ºåç¦»çº¿åˆ†æ

### æ‰¹é‡æ“ä½œ

æ‰¹é‡å¯¼å‡ºå»ºè®®ï¼š
- æ¯æ‰¹ä¸è¶…è¿‡ 50 ä¸ª jobs
- ä½¿ç”¨å¼‚æ­¥æ¨¡å¼ï¼ˆtask_id è½®è¯¢ï¼‰
- åœ¨ä½å³°æœŸæ‰§è¡Œ

---

## æµè§ˆå™¨å…¼å®¹æ€§

- **Chrome/Edge**: å®Œå…¨æ”¯æŒï¼ˆæ¨èï¼‰
- **Firefox**: å®Œå…¨æ”¯æŒ
- **Safari**: åŸºæœ¬æ”¯æŒï¼ˆéƒ¨åˆ† CSS å¯èƒ½ä¸åŒï¼‰
- **Mobile**: ä¸æ¨èï¼ˆå›¾å¯è§†åŒ–éœ€è¦å¤§å±å¹•ï¼‰

---

## æ•…éšœæ’æŸ¥

### é—®é¢˜: Evidence Graph ä¸æ˜¾ç¤º

**åŸå› **: JavaScript åº“åŠ è½½å¤±è´¥

**è§£å†³**: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼Œåˆ·æ–°é¡µé¢

### é—®é¢˜: èŠ‚ç‚¹å¤ªå¤šå¯¼è‡´å¡é¡¿

**åŸå› **: äº‹ä»¶æ•°è¿‡å¤šï¼ˆ> 5000ï¼‰

**è§£å†³**: 
1. ä½¿ç”¨è¿‡æ»¤å™¨
2. å¯¼å‡ºåç”¨ä¸“ä¸šå·¥å…·åˆ†æï¼ˆGephiã€Neo4jï¼‰

### é—®é¢˜: Audit Log ä¸ºç©º

**åŸå› **: M2 ä¹‹å‰çš„ jobs æ²¡æœ‰å®¡è®¡è®°å½•

**è§£å†³**: åªæœ‰ M2 ä¹‹åçš„è®¿é—®ä¼šè¢«è®°å½•

---

## é«˜çº§æŠ€å·§

### 1. å¯¼å‡º Evidence Graph ä¸ºå›¾ç‰‡

```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°
const png = cy.png({scale: 2, full: true});
const link = document.createElement('a');
link.href = png;
link.download = 'evidence-graph.png';
link.click();
```

### 2. å¯¼å‡ºä¸º JSON

```bash
curl http://api/jobs/job_123/evidence-graph > graph.json
```

### 3. åœ¨å¤–éƒ¨å·¥å…·åˆ†æ

å¯¼å‡ºçš„ graph.json å¯å¯¼å…¥åˆ°ï¼š
- Neo4jï¼ˆå›¾æ•°æ®åº“ï¼‰
- Gephiï¼ˆç½‘ç»œå¯è§†åŒ–ï¼‰
- Python NetworkXï¼ˆåˆ†æï¼‰

---

## ä¸‹ä¸€æ­¥

- æŸ¥çœ‹ `docs/m3-evidence-graph-guide.md` äº†è§£ Evidence Graph æ¦‚å¿µ
- æŸ¥çœ‹ `docs/m3-forensics-api-guide.md` äº†è§£ API è¯¦æƒ…
- æŸ¥çœ‹ `docs/2.0-milestones-overview.md` äº†è§£å®Œæ•´èƒ½åŠ›
